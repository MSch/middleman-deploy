<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Middleman Deploy by tvaughan</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Middleman Deploy</h1>
        <p class="header">Deploy a middleman built site over rsync, ftp, sftp, or git (e.g. gh-pages on github).</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/tvaughan/middleman-deploy/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/tvaughan/middleman-deploy/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/tvaughan/middleman-deploy">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/tvaughan">tvaughan</a></p>


      </header>
      <section>
        <h1>
<a name="middleman-deploy-" class="anchor" href="#middleman-deploy-"><span class="octicon octicon-link"></span></a>middleman-deploy <a href="https://travis-ci.org/tvaughan/middleman-deploy"><img src="https://travis-ci.org/tvaughan/middleman-deploy.png?branch=master" alt="Build Status"></a>
</h1>

<p>Deploys a <a href="http://middlemanapp.com/">middleman</a> built site via <strong>rsync</strong>,
<strong>ftp</strong>, <strong>sftp</strong>, or <strong>git</strong> (e.g. gh-pages on github).</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Add this to the Gemfile of the repository of your middleman site:</p>

<div class="highlight"><pre><span class="n">gem</span> <span class="s2">"middleman-deploy"</span>
</pre></div>

<p>and run <code>bundle install</code>.</p>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<pre><code>$ middleman build [--clean]
$ middleman deploy [--build-before]
</code></pre>

<p>To automatically run <code>middleman build</code> during <code>middleman deploy</code>, turn on the
<code>build_before</code> option while activating the deploy extension:</p>

<div class="highlight"><pre><span class="n">activate</span> <span class="ss">:deploy</span> <span class="k">do</span> <span class="o">|</span><span class="n">deploy</span><span class="o">|</span>
  <span class="c1"># ...</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">build_before</span> <span class="o">=</span> <span class="kp">true</span> <span class="c1"># default: false</span>
<span class="k">end</span>
</pre></div>

<h2>
<a name="possible-configurations" class="anchor" href="#possible-configurations"><span class="octicon octicon-link"></span></a>Possible Configurations</h2>

<p>Middleman-deploy can deploy a site via rsync, ftp, sftp, or git.</p>

<h3>
<a name="rsync" class="anchor" href="#rsync"><span class="octicon octicon-link"></span></a>rsync</h3>

<p>Make sure that <code>rsync</code> is installed, and activate the extension by adding the
following to <code>config.rb</code>:</p>

<div class="highlight"><pre><span class="n">activate</span> <span class="ss">:deploy</span> <span class="k">do</span> <span class="o">|</span><span class="n">deploy</span><span class="o">|</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="ss">:rsync</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">user</span>   <span class="o">=</span> <span class="s2">"tvaughan"</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">host</span>   <span class="o">=</span> <span class="s2">"www.example.com"</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">path</span>   <span class="o">=</span> <span class="s2">"/srv/www/site"</span>
  <span class="c1"># Optional Settings</span>
  <span class="c1"># deploy.port  = 5309 # ssh port, default: 22</span>
  <span class="c1"># deploy.clean = true # remove orphaned files on remote host, default: false</span>
<span class="k">end</span>
</pre></div>

<h3>
<a name="git-eg-github-pages" class="anchor" href="#git-eg-github-pages"><span class="octicon octicon-link"></span></a>Git (e.g. GitHub Pages)</h3>

<p>Make sure that <code>git</code> is installed, and activate the extension by adding the
following to <code>config.rb</code>:</p>

<div class="highlight"><pre><span class="n">activate</span> <span class="ss">:deploy</span> <span class="k">do</span> <span class="o">|</span><span class="n">deploy</span><span class="o">|</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="ss">:git</span>
  <span class="c1"># Optional Settings</span>
  <span class="c1"># deploy.remote = "custom-remote" # remote name or git url, default: origin</span>
  <span class="c1"># deploy.branch = "custom-branch" # default: gh-pages</span>
<span class="k">end</span>
</pre></div>

<p>If you use a remote name, you must first add it using <code>git remote add</code>. Run
<code>git remote -v</code> to see a list of possible remote names. If you use a git url,
it must end with '.git'.</p>

<p>Afterwards, the <code>build</code> directory will become a git repo. This branch will be
created on the remote if it doesn't already exist.</p>

<h3>
<a name="ftp" class="anchor" href="#ftp"><span class="octicon octicon-link"></span></a>FTP</h3>

<p>Activate the extension by adding the following to <code>config.rb</code>:</p>

<div class="highlight"><pre><span class="n">activate</span> <span class="ss">:deploy</span> <span class="k">do</span> <span class="o">|</span><span class="n">deploy</span><span class="o">|</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">method</span>   <span class="o">=</span> <span class="ss">:ftp</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">host</span>     <span class="o">=</span> <span class="s2">"ftp.example.com"</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">user</span>     <span class="o">=</span> <span class="s2">"tvaughan"</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="s2">"secret"</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">path</span>     <span class="o">=</span> <span class="s2">"/srv/www/site"</span>
<span class="k">end</span>
</pre></div>

<h3>
<a name="sftp" class="anchor" href="#sftp"><span class="octicon octicon-link"></span></a>SFTP</h3>

<p>Activate the extension by adding the following to <code>config.rb</code>:</p>

<div class="highlight"><pre><span class="n">activate</span> <span class="ss">:deploy</span> <span class="k">do</span> <span class="o">|</span><span class="n">deploy</span><span class="o">|</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">method</span>   <span class="o">=</span> <span class="ss">:sftp</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">host</span>     <span class="o">=</span> <span class="s2">"sftp.example.com"</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">user</span>     <span class="o">=</span> <span class="s2">"tvaughan"</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="s2">"secret"</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">path</span>     <span class="o">=</span> <span class="s2">"/srv/www/site"</span>
<span class="k">end</span>
</pre></div>

<h2>
<a name="breaking-changes" class="anchor" href="#breaking-changes"><span class="octicon octicon-link"></span></a>Breaking Changes</h2>

<ul>
<li>
<code>v0.1.0</code>

<ul>
<li>Removed the <code>--clean</code> command-line option. This option only applied to
the rsync deploy method. The idea going forward is that command-line
options must apply to all deploy methods. Options that are specific to a
deploy method will only be available in <code>config.rb</code>.</li>
<li>Removed <code>deploy</code> from the <code>after_build</code> hook. This caused a <code>deploy</code> to
be run each time <code>build</code> was called. This workflow never made
sense. <code>deploy</code> was added to the <code>after_build</code> hook simply because it
was available.</li>
</ul>
</li>
</ul><h2>
<a name="thanks" class="anchor" href="#thanks"><span class="octicon octicon-link"></span></a>Thanks!</h2>

<p>A <strong>BIG</strong> thanks to
<a href="https://github.com/tvaughan/middleman-deploy/graphs/contributors">everyone who has contributed</a>!
Almost all pull requests are accepted.</p>

<h2>
<a name="other" class="anchor" href="#other"><span class="octicon octicon-link"></span></a>Other</h2>

<p>Inspired by the rsync task in
<a href="https://github.com/imathis/octopress">Octopress</a>.</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>